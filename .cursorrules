# AviationWX.org Bridge

Go daemon for Raspberry Pi that captures webcam images and uploads to aviationwx.org.

## The Basics

This runs on Pi Zero 2 W (512MB RAM) so memory matters. Everything is designed around that constraint.

Web console runs on port 1229. Default password is "aviationwx".

Config version is 2. Upload credentials are per-camera, not global.

## EXIF

Use `exiftool` for all EXIF operations. Not PHP. Not Go libraries. This matches what the aviationwx.org server uses.

All timestamps go in as UTC with `OffsetTimeOriginal=+00:00`. We add a marker in UserComment: `AviationWX-Bridge:UTC:v1:source:confidence[:warn:code]`

## Time

Bridge clock (NTP-synced) is the authority. Camera EXIF is only used if it's within tolerance of bridge time. Cameras are assumed to be in the same timezone as the bridge.

## Queue

File-based in tmpfs at `/dev/shm/aviationwx`. Has health levels that trigger thinning when things back up.

## Deployment

Two paths:
- Pi: `install.sh` sets up Docker + supervisor for auto-updates
- Docker: Manual pulls, IT manages updates

## Testing

```
go test ./...
./scripts/test-ci-local.sh
make dev
```

## Code Guidelines

All code, comments, and documentation must follow [CODE_STYLE.md](CODE_STYLE.md). This includes Go formatting, naming, error handling, logging, and doc style.

## Before Committing

Major changes must be tested before commit. Run at minimum:
- `make check` (fmt, vet, Go tests, JS tests)
- For install/script changes: `./scripts/test-ci-local.sh` or manual install verification

## Repo Hygiene

Keep the repo clean. Do not commit AI-generated working docs (analysis, summaries, checklists, implementation plans, etc.). It's fine to create them during work, but remove or consolidate them before commit. Only commit docs that belong in the repo long-term.
